<!DOCTYPE html>
<html>
<head>
<title>Уведомления</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style>

    h3{
        text-align:center;
    }
    table{
        margin: auto;
        text-align:center;
        border-collapse: collapse;
    }
    .train{
        padding-left: 15px;
        padding-right: 5px;
    }
    .time{
        font-size: 1.5em;
    }
    .space{
        width:50%;
    }
    .red{
        color:red;
    }
    .route{
        padding-right: 20px;
        white-space: nowrap;
    }
    .green{
        color:green;
    }
    .past{
        color:gray;
    }

    .active{

    }
    .active.red{
        background-color: red;
        border:1px solid red;
        color: white;

    }
    .active.green{
        background-color: green;
        border:1px solid green;
        color: white;
    }
    date{
        position: absolute;
        margin-left: 75%;
    }
    main{
        position: absolute;
        margin: auto;
        height: 85%;
/*        width: 95%;*/
        overflow: scroll;
        overflow-x: hidden;
    }
    ::-webkit-scrollbar {
      width: 0;
    }

</style>
    
</head>
<body>
<date>17.05.2021</date>
<h3>Cтанция "Выборг"</h3>
<main>
<table>
<tr class="green"><td class="space">    </td><td class="route">05:00 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">05:00</td><td id="note0"></td><td class=    "route">до ст. Санкт-Петербург 07:10</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">06:16 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">06:16</td><td id="note1"></td><td class=    "route">до ст. Санкт-Петербург 08:44</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">06:47 от ст.     Санкт-Петербург</td><td class="train">Пригородный</td>    <td class="time">08:56</td><td id="note2"></td><td class=    "route">до ст. Выборг 08:56</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">06:57 от ст.     Выборг</td><td class="train">Ласточка</td>    <td class="time">06:57</td><td id="note3"></td><td class=    "route">до ст. Санкт-Петербург 08:12</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">07:55 от ст.     Санкт-Петербург</td><td class="train">Ласточка</td>    <td class="time">09:10</td><td id="note4"></td><td class=    "route">до ст. Выборг 09:10</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">07:58 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">07:58</td><td id="note5"></td><td class=    "route">до ст. Санкт-Петербург 10:26</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">09:22 от ст.     Выборг</td><td class="train">Ласточка</td>    <td class="time">09:22</td><td id="note6"></td><td class=    "route">до ст. Санкт-Петербург 10:37</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">09:30 от ст.     Санкт-Петербург</td><td class="train">Ласточка</td>    <td class="time">10:45</td><td id="note7"></td><td class=    "route">до ст. Выборг 10:45</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">09:35 от ст.     Санкт-Петербург</td><td class="train">Пригородный</td>    <td class="time">11:49</td><td id="note8"></td><td class=    "route">до ст. Выборг 11:49</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">09:52 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">09:52</td><td id="note9"></td><td class=    "route">до ст. Санкт-Петербург 12:00</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">11:57 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">11:57</td><td id="note10"></td><td class=    "route">до ст. Санкт-Петербург 14:07</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">13:02 от ст.     Выборг</td><td class="train">Ласточка</td>    <td class="time">13:02</td><td id="note11"></td><td class=    "route">до ст. Санкт-Петербург 14:17</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">13:50 от ст.     Санкт-Петербург</td><td class="train">Ласточка</td>    <td class="time">15:05</td><td id="note12"></td><td class=    "route">до ст. Выборг 15:05</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">13:55 от ст.     Санкт-Петербург</td><td class="train">Пригородный</td>    <td class="time">16:06</td><td id="note13"></td><td class=    "route">до ст. Выборг 16:06</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">15:33 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">15:33</td><td id="note14"></td><td class=    "route">до ст. Санкт-Петербург 17:45</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">15:40 от ст.     Санкт-Петербург</td><td class="train">Ласточка</td>    <td class="time">16:55</td><td id="note15"></td><td class=    "route">до ст. Выборг 16:55</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">15:50 от ст.     Санкт-Петербург</td><td class="train">Пригородный</td>    <td class="time">18:01</td><td id="note16"></td><td class=    "route">до ст. Выборг 18:01</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">16:31 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">16:31</td><td id="note17"></td><td class=    "route">до ст. Санкт-Петербург 19:05</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">17:05 от ст.     Выборг</td><td class="train">Ласточка</td>    <td class="time">17:05</td><td id="note18"></td><td class=    "route">до ст. Санкт-Петербург 18:20</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">17:23 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">17:23</td><td id="note19"></td><td class=    "route">до ст. Санкт-Петербург 21:45</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">18:15 от ст.     Санкт-Петербург</td><td class="train">Ласточка</td>    <td class="time">19:30</td><td id="note20"></td><td class=    "route">до ст. Выборг 19:30</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">18:28 от ст.     Санкт-Петербург</td><td class="train">Пригородный</td>    <td class="time">21:06</td><td id="note21"></td><td class=    "route">до ст. Выборг 21:06</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">18:39 от ст.     Санкт-Петербург</td><td class="train">Пригородный</td>    <td class="time">22:49</td><td id="note22"></td><td class=    "route">до ст. Выборг 22:49</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">18:40 от ст.     Выборг</td><td class="train">Ласточка</td>    <td class="time">18:40</td><td id="note23"></td><td class=    "route">до ст. Санкт-Петербург 19:55</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">19:38 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">19:38</td><td id="note24"></td><td class=    "route">до ст. Санкт-Петербург 21:51</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">20:42 от ст.     Санкт-Петербург</td><td class="train">Ласточка</td>    <td class="time">21:57</td><td id="note25"></td><td class=    "route">до ст. Выборг 21:57</td>    <td class="space"></td></tr>
<tr class="red"><td class="space">    </td><td class="route">20:44 от ст.     Выборг</td><td class="train">Ласточка</td>    <td class="time">20:44</td><td id="note26"></td><td class=    "route">до ст. Санкт-Петербург 21:59</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">20:47 от ст.     Санкт-Петербург</td><td class="train">Пригородный</td>    <td class="time">22:58</td><td id="note27"></td><td class=    "route">до ст. Выборг 22:58</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">20:50 от ст.     Выборг</td><td class="train">Пригородный</td>    <td class="time">20:50</td><td id="note28"></td><td class=    "route">до ст. Санкт-Петербург 23:16</td>    <td class="space"></td></tr>
<tr class="green"><td class="space">    </td><td class="route">22:24 от ст.     Санкт-Петербург</td><td class="train">Пригородный</td>    <td class="time">00:32</td><td id="note29"></td><td class=    "route">до ст. Выборг 00:32</td>    <td class="space"></td></tr>
</table>
</main>
</body>
<script>
let l=[500,616,647,657,755,758,922,930,935,952,1157,1302,1350,1355,1533,1540,1550,1631,1705,1723,1815,1828,1839,1840,1938,2042,2044,2047,2050,2224];
    let noticTime=15; // в минутах
    let soundTime=3;
    let table=document.querySelector('tbody').children;
    let date = new Date();
    let time = date.getHours()*100+date.getMinutes();
    let i;
    let activeList=[];
    for(i=0; i<l.length; i++){
        if(l[i]<time){
            table[i].classList.add('past');
        }else{
            if(l[i]<(time+noticTime)){
                    table[i].classList.add('active');
                    activeList.push([l[i],i]);

                }else if(activeList.length==0){
                    table[i].classList.add('active');
                    activeList.push([l[i],i]);
                    i++
                    break;
                }else{
                    break;
                }
        }
    }

    function f(){
        date = new Date();
        time = date.getHours()*100+date.getMinutes();
//конец списка
        if(l[i]==undefined){
            console.log('конец списка');
            console.log(time);
            if(activeList[0][0]<time+soundTime){
               ;
               // проиграть уведомление
               }
            if (activeList[0][0]<time-2){
                table[activeList[0][1]].classList.remove('active');
                table[activeList[0][1]].classList.add('past');
                activeList.splice(0,1);
                if(activeList.length==0){
                    clearTimeout(timerId);
                    console.log('stop');
                    console.log(time);
                    }
                }
            return;
        }
        if (activeList[0][0]<time-2){
            table[activeList[0][1]].classList.remove('active');
            table[activeList[0][1]].classList.add('past');
            activeList.splice(0,1);
            if(activeList.length==0){
                activeList.push([l[i],i]);
                table[i].classList.add('active');
                i++;
            }
        }
        if(l[i]<(time+noticTime)){
            activeList.push([l[i],i]);
            table[i].classList.add('active');
            i++;
        }
        if(i>3){
            table[i-3].scrollIntoView();
        }
    }
    f();
    let timerId=setInterval(f,50000);

</script>
</html>
